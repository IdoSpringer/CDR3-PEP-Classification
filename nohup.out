/home/dsi/speingi/anaconda3/envs/tf_gpu/lib/python3.6/site-packages/sklearn/externals/joblib/externals/cloudpickle/cloudpickle.py:47: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
Traceback (most recent call last):
  File "tcr_ae_pep_lstm_train.py", line 255, in <module>
    main(sys.argv)
  File "tcr_ae_pep_lstm_train.py", line 227, in main
    train, test = d2.load_data(pairs_file)
  File "/home/dsi/speingi/PycharmProjects/CDR3-PEP-Classification/load_with_tcrgp.py", line 94, in load_data
    train_pos, train_neg, test_pos, test_neg = get_examples(pairs_file)
  File "/home/dsi/speingi/PycharmProjects/CDR3-PEP-Classification/load_with_tcrgp.py", line 85, in get_examples
    neg_train, neg_test = read_negs('TCRGP/training_data')
  File "/home/dsi/speingi/PycharmProjects/CDR3-PEP-Classification/load_with_tcrgp.py", line 56, in read_negs
    csv_ = csv.reader(csv_file)
NameError: name 'csv' is not defined
/home/dsi/speingi/anaconda3/envs/tf_gpu/lib/python3.6/site-packages/sklearn/externals/joblib/externals/cloudpickle/cloudpickle.py:47: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
/home/dsi/speingi/anaconda3/envs/tf_gpu/lib/python3.6/site-packages/torch/nn/functional.py:1006: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/dsi/speingi/anaconda3/envs/tf_gpu/lib/python3.6/site-packages/torch/nn/functional.py:1594: UserWarning: Using a target size (torch.Size([50])) that is different to the input size (torch.Size([50, 1])) is deprecated. Please ensure they have the same size.
  "Please ensure they have the same size.".format(target.size(), input.size()))
epoch: 1
train auc: 0.7223879971940406
test auc: 0.6447772657450077
one epoch time: 1.1997380256652832
epoch: 2
train auc: 0.7703177454096197
test auc: 0.6728910650281619
one epoch time: 0.8695130348205566
epoch: 3
train auc: 0.8023059695170761
test auc: 0.6740911418330773
one epoch time: 1.2123286724090576
epoch: 4
train auc: 0.8302737143080139
test auc: 0.675739247311828
one epoch time: 1.1813077926635742
epoch: 5
train auc: 0.8543233002195845
test auc: 0.680507552483359
one epoch time: 1.02915358543396
epoch: 6
train auc: 0.8781501607144728
test auc: 0.6907482078853047
one epoch time: 1.1799895763397217
epoch: 7
train auc: 0.8917192784077226
test auc: 0.6998367895545317
one epoch time: 1.1460788249969482
epoch: 8
train auc: 0.9110821123887681
test auc: 0.7019009216589862
one epoch time: 2.232954263687134
epoch: 9
train auc: 0.9277389277389276
test auc: 0.719518049155146
one epoch time: 1.1533136367797852
epoch: 10
train auc: 0.9422198870953464
test auc: 0.7196140552995391
one epoch time: 1.0758960247039795
epoch: 11
train auc: 0.9541080941652603
test auc: 0.7200300819252432
one epoch time: 1.2907516956329346
epoch: 12
train auc: 0.961576058350252
test auc: 0.7292626728110598
one epoch time: 1.191152572631836
epoch: 13
train auc: 0.9651053995684457
test auc: 0.7257904505888377
one epoch time: 1.1971020698547363
epoch: 14
train auc: 0.9739049571634301
test auc: 0.7228622631848438
one epoch time: 1.0910468101501465
epoch: 15
train auc: 0.9787754099718167
test auc: 0.7435835893497182
one epoch time: 1.1753954887390137
epoch: 16
train auc: 0.9840694217991074
test auc: 0.7328469022017409
one epoch time: 1.0648419857025146
epoch: 17
train auc: 0.9854152924794002
test auc: 0.7384632616487455
one epoch time: 1.111419916152954
epoch: 18
train auc: 0.9877091739076221
test auc: 0.7300627240143369
one epoch time: 0.7619731426239014
epoch: 19
train auc: 0.991244226033936
test auc: 0.7359671018945213
one epoch time: 0.7340655326843262
epoch: 20
train auc: 0.993435311115997
test auc: 0.7386072708653355
one epoch time: 0.7474281787872314
epoch: 21
train auc: 0.9938512555907411
test auc: 0.7437435995903737
one epoch time: 1.1199469566345215
epoch: 22
train auc: 0.9958748207012804
test auc: 0.7458877368151562
one epoch time: 1.1803371906280518
epoch: 23
train auc: 0.9956330589241982
test auc: 0.7445276497695853
one epoch time: 1.2029318809509277
epoch: 24
train auc: 0.9970284241415315
test auc: 0.7492639528929851
one epoch time: 1.2188284397125244
epoch: 25
train auc: 0.9972130768374133
test auc: 0.7463677675371223
one epoch time: 1.1160953044891357
epoch: 26
train auc: 0.9988425892876689
test auc: 0.7431835637480797
one epoch time: 1.1119112968444824
epoch: 27
train auc: 0.9991100501512915
test auc: 0.7404313876088069
one epoch time: 1.0231423377990723
epoch: 28
train auc: 0.998646514775547
test auc: 0.7345110087045571
one epoch time: 1.2520794868469238
epoch: 29
train auc: 0.9990596037962309
test auc: 0.7529441884280594
one epoch time: 1.1580047607421875
epoch: 30
train auc: 0.9990767365205913
test auc: 0.7379352278545827
one epoch time: 1.3072733879089355
epoch: 31
train auc: 0.9995412237143556
test auc: 0.7415994623655914
one epoch time: 1.1503691673278809
epoch: 32
train auc: 0.9990510374340509
test auc: 0.7343029953917051
one epoch time: 1.0511891841888428
epoch: 33
train auc: 0.999901010925919
test auc: 0.7347670250896058
one epoch time: 0.9511995315551758
epoch: 34
train auc: 0.9996154655199163
test auc: 0.7478158602150539
one epoch time: 1.1935374736785889
epoch: 35
train auc: 0.9998191545761982
test auc: 0.7522561443932412
one epoch time: 1.1937553882598877
epoch: 36
train auc: 0.999684948235377
test auc: 0.7413274449564772
one epoch time: 1.1356821060180664
epoch: 37
train auc: 0.9998591309330386
test auc: 0.7378632232462877
one epoch time: 1.1726326942443848
epoch: 38
train auc: 0.9999723972774197
test auc: 0.7447356630824373
one epoch time: 1.089094638824463
epoch: 39
train auc: 0.9998267691203583
test auc: 0.7398473502304148
one epoch time: 1.2177681922912598
epoch: 40
train auc: 0.9997363464084575
test auc: 0.7484158986175116
one epoch time: 0.9603490829467773
epoch: 41
train auc: 0.9999809636395999
test auc: 0.7444636456733231
one epoch time: 1.15694260597229
epoch: 42
train auc: 0.9998781672934388
test auc: 0.7411354326676908
one epoch time: 1.0887513160705566
epoch: 43
train auc: 0.9999838190936599
test auc: 0.7422795058883769
one epoch time: 1.0281846523284912
epoch: 44
train auc: 0.9999895300017799
test auc: 0.7576804915514592
one epoch time: 1.346071720123291
epoch: 45
train auc: 0.99999333727386
test auc: 0.7432235663082437
one epoch time: 1.075117588043213
epoch: 46
train auc: 1.0
test auc: 0.7482638888888888
one epoch time: 1.121687412261963
epoch: 47
train auc: 1.0
test auc: 0.7508320532514081
one epoch time: 0.9964051246643066
epoch: 48
train auc: 0.99999714454594
test auc: 0.733470942140297
one epoch time: 1.2074902057647705
epoch: 49
train auc: 0.99999904818198
test auc: 0.7419914874551972
one epoch time: 1.1969141960144043
epoch: 50
train auc: 0.99999904818198
test auc: 0.7393833205325142
one epoch time: 1.2087633609771729
epoch: 51
train auc: 1.0
test auc: 0.7464237711213517
one epoch time: 1.0556979179382324
epoch: 52
train auc: 1.0
test auc: 0.7535842293906809
one epoch time: 1.1689355373382568
epoch: 53
train auc: 1.0
test auc: 0.7439116103430621
one epoch time: 1.0993821620941162
epoch: 54
train auc: 0.9999952409099
test auc: 0.758872567844342
one epoch time: 1.1220800876617432
epoch: 55
train auc: 0.9999800118215798
test auc: 0.7491919482846903
one epoch time: 1.2372462749481201
epoch: 56
train auc: 1.0
test auc: 0.7508800563236047
one epoch time: 1.1503658294677734
epoch: 57
train auc: 1.0
test auc: 0.7625448028673836
one epoch time: 1.2846026420593262
epoch: 58
train auc: 0.99999904818198
test auc: 0.7532082053251408
one epoch time: 1.0165393352508545
epoch: 59
train auc: 0.9999933372738599
test auc: 0.7599846390168971
one epoch time: 1.2463383674621582
epoch: 60
train auc: 0.9999885781837599
test auc: 0.7541682667690733
one epoch time: 1.1457107067108154
epoch: 61
train auc: 0.99999714454594
test auc: 0.7526401689708141
one epoch time: 1.1343789100646973
epoch: 62
train auc: 1.0
test auc: 0.7482158858166923
one epoch time: 1.0881924629211426
epoch: 63
train auc: 1.0
test auc: 0.753240207373272
one epoch time: 1.0986428260803223
epoch: 64
train auc: 1.0
test auc: 0.7540002560163851
one epoch time: 1.235696792602539
epoch: 65
train auc: 1.0
test auc: 0.7474798387096775
one epoch time: 0.9798908233642578
epoch: 66
train auc: 0.9999419391007794
test auc: 0.7497039810547875
one epoch time: 1.1468238830566406
epoch: 67
train auc: 1.0
test auc: 0.7569124423963134
one epoch time: 1.1802043914794922
epoch: 68
train auc: 1.0
test auc: 0.7542242703533026
one epoch time: 1.1108777523040771
epoch: 69
train auc: 1.0
test auc: 0.7612007168458782
one epoch time: 1.1346776485443115
epoch: 70
train auc: 0.99999809636396
test auc: 0.7471038146441373
one epoch time: 1.0889909267425537
epoch: 71
train auc: 0.99999904818198
test auc: 0.7471678187403993
one epoch time: 0.7339773178100586
epoch: 72
train auc: 1.0
test auc: 0.7475358422939067
one epoch time: 0.7411584854125977
epoch: 73
train auc: 0.99999143363782
test auc: 0.759088581669227
one epoch time: 0.731673002243042
epoch: 74
train auc: 0.99999809636396
test auc: 0.7472798259088581
one epoch time: 0.7319278717041016
epoch: 75
train auc: 1.0
test auc: 0.747599846390169
one epoch time: 1.2033345699310303
epoch: 76
train auc: 0.9999790600035597
test auc: 0.7459277393753201
one epoch time: 1.0870678424835205
epoch: 77
train auc: 0.99999809636396
test auc: 0.7457917306707629
one epoch time: 1.2637629508972168
epoch: 78
train auc: 0.99999904818198
test auc: 0.7458077316948286
one epoch time: 1.136967658996582
epoch: 79
train auc: 0.99999904818198
test auc: 0.7594886072708652
one epoch time: 1.0370519161224365
epoch: 80
train auc: 1.0
test auc: 0.7614487327188939
one epoch time: 1.2302958965301514
epoch: 81
train auc: 0.99999143363782
test auc: 0.7552483358934973
one epoch time: 1.1115365028381348
epoch: 82
train auc: 0.9999895300017799
test auc: 0.7491119431643626
one epoch time: 1.1414082050323486
epoch: 83
train auc: 0.99999904818198
test auc: 0.7484639016897081
one epoch time: 1.2102117538452148
epoch: 84
train auc: 1.0
test auc: 0.749687980030722
one epoch time: 0.9860231876373291
epoch: 85
train auc: 1.0
test auc: 0.7428715437788018
one epoch time: 1.1679306030273438
epoch: 86
train auc: 1.0
test auc: 0.7435195852534562
one epoch time: 1.1973991394042969
epoch: 87
train auc: 1.0
test auc: 0.7572644649257554
one epoch time: 1.1329169273376465
epoch: 88
train auc: 1.0
test auc: 0.7572804659498209
one epoch time: 1.166126012802124
epoch: 89
train auc: 1.0
test auc: 0.7554323476702509
one epoch time: 1.1506197452545166
epoch: 90
train auc: 1.0
test auc: 0.745719726062468
one epoch time: 1.0126378536224365
epoch: 91
train auc: 1.0
test auc: 0.7603206605222734
one epoch time: 1.1562414169311523
epoch: 92
train auc: 0.9999771563675197
test auc: 0.7525841653865848
one epoch time: 1.208423376083374
epoch: 93
train auc: 0.99999904818198
test auc: 0.757440476190476
one epoch time: 1.1601464748382568
epoch: 94
train auc: 0.99999809636396
test auc: 0.7603446620583718
one epoch time: 1.0638000965118408
epoch: 95
train auc: 1.0
test auc: 0.7617927547363031
one epoch time: 1.1350808143615723
epoch: 96
train auc: 1.0
test auc: 0.7560963901689708
one epoch time: 1.192049264907837
epoch: 97
train auc: 1.0
test auc: 0.7462237583205327
one epoch time: 1.0572257041931152
epoch: 98
train auc: 1.0
test auc: 0.7449116743471582
one epoch time: 1.180241584777832
epoch: 99
train auc: 1.0
test auc: 0.7527841781874038
one epoch time: 1.1786541938781738
epoch: 100
train auc: 1.0
test auc: 0.7542002688172043
one epoch time: 1.3339054584503174
epoch: 101
train auc: 1.0
test auc: 0.7477758576548899
one epoch time: 1.3256916999816895
epoch: 102
train auc: 1.0
test auc: 0.7489599334357399
one epoch time: 1.2222247123718262
epoch: 103
train auc: 1.0
test auc: 0.75577636968766
one epoch time: 1.2008082866668701
epoch: 104
train auc: 1.0
test auc: 0.7577044930875576
one epoch time: 1.2269878387451172
epoch: 105
train auc: 1.0
test auc: 0.7495999743983615
one epoch time: 1.0733604431152344
epoch: 106
train auc: 1.0
test auc: 0.7508400537634408
one epoch time: 1.1025521755218506
epoch: 107
train auc: 1.0
test auc: 0.7655129928315413
one epoch time: 0.998460054397583
epoch: 108
train auc: 1.0
test auc: 0.7399993599590375
one epoch time: 1.220395803451538
epoch: 109
train auc: 1.0
test auc: 0.7585845494111623
one epoch time: 1.1486740112304688
epoch: 110
train auc: 1.0
test auc: 0.7552883384536611
one epoch time: 1.0144717693328857
epoch: 111
train auc: 1.0
test auc: 0.752472158218126
one epoch time: 1.1204252243041992
epoch: 112
train auc: 1.0
test auc: 0.7519201228878648
one epoch time: 1.2637724876403809
epoch: 113
train auc: 1.0
test auc: 0.7511280721966207
one epoch time: 1.118910551071167
epoch: 114
train auc: 1.0
test auc: 0.7468237967229903
one epoch time: 1.0442578792572021
epoch: 115
train auc: 1.0
test auc: 0.736287122375832
one epoch time: 1.1604037284851074
epoch: 116
train auc: 0.9999942890918799
test auc: 0.740495391705069
one epoch time: 1.1734271049499512
epoch: 117
train auc: 0.99999619272792
test auc: 0.7464077700972862
one epoch time: 1.0874888896942139
epoch: 118
train auc: 1.0
test auc: 0.7393913210445469
one epoch time: 1.1262423992156982
epoch: 119
train auc: 0.99999809636396
test auc: 0.7419914874551973
one epoch time: 1.1333489418029785
epoch: 120
train auc: 1.0
test auc: 0.7436555939580133
one epoch time: 1.1955838203430176
epoch: 121
train auc: 1.0
test auc: 0.7421834997439837
one epoch time: 1.2097301483154297
epoch: 122
train auc: 1.0
test auc: 0.7419434843830006
one epoch time: 1.2603812217712402
epoch: 123
train auc: 1.0
test auc: 0.7405753968253967
one epoch time: 1.2979471683502197
epoch: 124
train auc: 1.0
test auc: 0.7442716333845366
one epoch time: 0.9572334289550781
epoch: 125
train auc: 0.9999952409098999
test auc: 0.7380072324628777
one epoch time: 0.9712135791778564
epoch: 126
train auc: 1.0
test auc: 0.7454957117255505
one epoch time: 0.8712053298950195
epoch: 127
train auc: 0.99999238545584
test auc: 0.7393833205325141
one epoch time: 0.8701257705688477
epoch: 128
train auc: 0.99999714454594
test auc: 0.7464397721454172
one epoch time: 1.0495705604553223
epoch: 129
train auc: 0.99999809636396
test auc: 0.7355670762928826
one epoch time: 1.1443991661071777
epoch: 130
train auc: 1.0
test auc: 0.7428715437788018
one epoch time: 1.1481568813323975
epoch: 131
train auc: 1.0
test auc: 0.7431515616999488
one epoch time: 1.189847707748413
epoch: 132
train auc: 0.99999904818198
test auc: 0.7467997951868919
one epoch time: 1.1757757663726807
epoch: 133
train auc: 1.0
test auc: 0.7446556579621095
one epoch time: 1.1354761123657227
epoch: 134
train auc: 1.0
test auc: 0.7481838837685613
one epoch time: 1.1629278659820557
epoch: 135
train auc: 1.0
test auc: 0.7500160010240656
one epoch time: 1.1578564643859863
epoch: 136
train auc: 1.0
test auc: 0.748679915514593
one epoch time: 1.0606074333190918
epoch: 137
train auc: 1.0
test auc: 0.7618967613927292
one epoch time: 0.9665436744689941
epoch: 138
train auc: 1.0
test auc: 0.7564324116743472
one epoch time: 1.1579103469848633
epoch: 139
train auc: 1.0
test auc: 0.7458397337429595
one epoch time: 1.0947754383087158
epoch: 140
train auc: 1.0
test auc: 0.7378872247823861
one epoch time: 1.1717877388000488
epoch: 141
train auc: 1.0
test auc: 0.7331749231950844
one epoch time: 1.2431838512420654
epoch: 142
train auc: 1.0
test auc: 0.7380232334869432
one epoch time: 1.1296889781951904
epoch: 143
train auc: 1.0
test auc: 0.7508000512032771
one epoch time: 1.046464443206787
epoch: 144
train auc: 1.0
test auc: 0.7534962237583204
one epoch time: 1.255305290222168
epoch: 145
train auc: 1.0
test auc: 0.7596726190476191
one epoch time: 1.2389895915985107
epoch: 146
train auc: 0.99999904818198
test auc: 0.7537522401433692
one epoch time: 1.3446311950683594
epoch: 147
train auc: 0.9999895300017799
test auc: 0.7467037890424987
one epoch time: 1.2591302394866943
epoch: 148
train auc: 1.0
test auc: 0.7543522785458269
one epoch time: 1.3499493598937988
epoch: 149
train auc: 1.0
test auc: 0.7574724782386073
one epoch time: 1.1051688194274902
epoch: 150
train auc: 1.0
test auc: 0.7569844470046083
one epoch time: 1.070878267288208
epoch: 151
train auc: 1.0
test auc: 0.7506400409626217
one epoch time: 1.1112477779388428
epoch: 152
train auc: 1.0
test auc: 0.7462157578084997
one epoch time: 1.10638427734375
epoch: 153
train auc: 1.0
test auc: 0.7619207629288275
one epoch time: 1.260420799255371
epoch: 154
train auc: 1.0
test auc: 0.7722494239631337
one epoch time: 1.0506410598754883
epoch: 155
train auc: 0.9999895300017799
test auc: 0.7636888760880697
one epoch time: 1.1897525787353516
epoch: 156
train auc: 0.99999714454594
test auc: 0.7579845110087045
one epoch time: 0.9839012622833252
epoch: 157
train auc: 1.0
test auc: 0.7582565284178188
one epoch time: 1.1193180084228516
epoch: 158
train auc: 1.0
test auc: 0.7682891705069126
one epoch time: 0.9672348499298096
epoch: 159
train auc: 0.9997315873183574
test auc: 0.766185035842294
one epoch time: 1.1726047992706299
epoch: 160
train auc: 0.99999904818198
test auc: 0.7433995775729647
one epoch time: 1.0584712028503418
epoch: 161
train auc: 1.0
test auc: 0.747287826420891
one epoch time: 1.1857147216796875
epoch: 162
train auc: 1.0
test auc: 0.7553123399897594
one epoch time: 1.0007355213165283
epoch: 163
train auc: 1.0
test auc: 0.7489199308755761
one epoch time: 1.0229461193084717
epoch: 164
train auc: 1.0
test auc: 0.7531282002048131
one epoch time: 1.1128346920013428
epoch: 165
train auc: 1.0
test auc: 0.7593766001024065
one epoch time: 1.0503134727478027
epoch: 166
train auc: 1.0
test auc: 0.7609447004608294
one epoch time: 0.9967033863067627
epoch: 167
train auc: 1.0
test auc: 0.7597206221198157
one epoch time: 1.1592638492584229
epoch: 168
train auc: 1.0
test auc: 0.7494879672299029
one epoch time: 1.1487245559692383
epoch: 169
train auc: 1.0
test auc: 0.74895993343574
one epoch time: 1.2118520736694336
epoch: 170
train auc: 1.0
test auc: 0.7544962877624168
one epoch time: 1.0603766441345215
epoch: 171
train auc: 1.0
test auc: 0.7522401433691757
one epoch time: 1.072072982788086
epoch: 172
train auc: 1.0
test auc: 0.7530641961085509
one epoch time: 1.0098285675048828
epoch: 173
train auc: 1.0
test auc: 0.7525681643625193
one epoch time: 1.1959922313690186
epoch: 174
train auc: 1.0
test auc: 0.7549843189964157
one epoch time: 1.2167348861694336
epoch: 175
train auc: 1.0
test auc: 0.7580085125448028
one epoch time: 1.220064401626587
epoch: 176
train auc: 1.0
test auc: 0.7553523425499232
one epoch time: 1.309706211090088
epoch: 177
train auc: 1.0
test auc: 0.7458877368151562
one epoch time: 1.2144629955291748
epoch: 178
train auc: 0.99999904818198
test auc: 0.7474158346134152
one epoch time: 0.9642150402069092
epoch: 179
train auc: 1.0
test auc: 0.754840309779826
one epoch time: 0.8026657104492188
epoch: 180
train auc: 1.0
test auc: 0.7430715565796211
one epoch time: 0.7863624095916748
epoch: 181
train auc: 1.0
test auc: 0.7427195340501793
one epoch time: 0.8154046535491943
epoch: 182
train auc: 0.9999847709116799
test auc: 0.7531522017409114
one epoch time: 1.035170316696167
epoch: 183
train auc: 1.0
test auc: 0.7482238863287252
one epoch time: 1.1263442039489746
epoch: 184
train auc: 0.99999904818198
test auc: 0.7537922427035331
one epoch time: 1.2304112911224365
epoch: 185
train auc: 1.0
test auc: 0.7635768689196109
one epoch time: 1.077197551727295
epoch: 186
train auc: 1.0
test auc: 0.7679691500256016
one epoch time: 1.1355624198913574
epoch: 187
train auc: 0.99999714454594
test auc: 0.7685691884280594
one epoch time: 1.1876118183135986
epoch: 188
train auc: 1.0
test auc: 0.7684091781874041
one epoch time: 0.9742658138275146
epoch: 189
train auc: 1.0
test auc: 0.7664730542754736
one epoch time: 1.218482255935669
epoch: 190
train auc: 1.0
test auc: 0.759152585765489
one epoch time: 1.316680908203125
epoch: 191
train auc: 1.0
test auc: 0.7607686891961084
one epoch time: 1.2416996955871582
epoch: 192
train auc: 0.9999952409099
test auc: 0.7546482974910393
one epoch time: 1.1168415546417236
epoch: 193
train auc: 0.9999723972774198
test auc: 0.763088837685612
one epoch time: 1.1917099952697754
epoch: 194
train auc: 0.9999942890918799
test auc: 0.7573124679979518
one epoch time: 1.166649580001831
epoch: 195
train auc: 0.9999067218340392
test auc: 0.7587045570916539
one epoch time: 1.1500368118286133
epoch: 196
train auc: 1.0
test auc: 0.7686891961085509
one epoch time: 0.9914467334747314
epoch: 197
train auc: 1.0
test auc: 0.7681931643625193
one epoch time: 1.1799485683441162
epoch: 198
train auc: 1.0
test auc: 0.7704493087557605
one epoch time: 1.144655466079712
epoch: 199
train auc: 1.0
test auc: 0.7707293266769073
one epoch time: 1.1752147674560547
epoch: 200
train auc: 1.0
test auc: 0.7739055299539171
one epoch time: 1.1129717826843262
/home/dsi/speingi/anaconda3/envs/tf_gpu/lib/python3.6/site-packages/sklearn/externals/joblib/externals/cloudpickle/cloudpickle.py:47: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
Traceback (most recent call last):
  File "tcr_ae_pep_lstm_train.py", line 257, in <module>
    main(sys.argv)
  File "tcr_ae_pep_lstm_train.py", line 233, in main
    train_batches = get_batches(train_tcrs, train_peps, train_signs, tcr_atox, pep_atox, params['batch_size'], params['max_len'])
  File "tcr_ae_pep_lstm_train.py", line 82, in get_batches
    convert_data(tcrs, peps, tcr_atox, pep_atox, max_length)
  File "tcr_ae_pep_lstm_train.py", line 38, in convert_data
    tcrs[i] = pad_tcr(tcrs[i], tcr_atox, max_len)
  File "tcr_ae_pep_lstm_train.py", line 47, in pad_tcr
    padding[i][amino_to_ix[amino]] = 1
IndexError: index 28 is out of bounds for dimension 0 with size 28
/home/dsi/speingi/anaconda3/envs/tf_gpu/lib/python3.6/site-packages/sklearn/externals/joblib/externals/cloudpickle/cloudpickle.py:47: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
Traceback (most recent call last):
  File "tcr_ae_pep_lstm_train.py", line 257, in <module>
    main(sys.argv)
  File "tcr_ae_pep_lstm_train.py", line 238, in main
    test_batches = get_batches(test_tcrs, test_peps, test_signs, tcr_atox, pep_atox, params['batch_size'], params['max_len'])
  File "tcr_ae_pep_lstm_train.py", line 82, in get_batches
    convert_data(tcrs, peps, tcr_atox, pep_atox, max_length)
  File "tcr_ae_pep_lstm_train.py", line 38, in convert_data
    tcrs[i] = pad_tcr(tcrs[i], tcr_atox, max_len)
  File "tcr_ae_pep_lstm_train.py", line 47, in pad_tcr
    padding[i][amino_to_ix[amino]] = 1
IndexError: index 28 is out of bounds for dimension 0 with size 28
